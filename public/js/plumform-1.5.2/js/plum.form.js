/*!
 * plum.Form v1.5.2: Styling web forms
 *
 * Copyright 2011 RoboCr√©atif, LLC
 * <http://robocreatif.com>
 *
 * Date: 15 January, 2012
 */
(function(a){a.expr[":"].plum=function(b){return !!a(b).data("plum-form")};plum.form=function(c,d){var b=plum.form.prototype;if(typeof c==="string"){return this.each(b.validate(d))}c=c||{};c.listen=typeof c.listen==="undefined"?true:c.listen;this.each(b.init(c));if(this.selector&&c.listen){b.selectors[this.selector]=c;b.listen(this.selector)}return this};plum.form.prototype={options:{action:null,ajax:false,complete:function(){},classes:{active:"active",arrow:"select-arrow",button:"button",checkbox:"checkbox",checked:"checked",closed:"closed",color:"color",container:"select-container",date:"date",datetime:"datetime",disabled:"disabled",file:"file",filelist:"filelist",focus:"focus",email:"email",error:"error",hover:"hover",info:"info",input:"input",invalid:"invalid",label:"label",loading:"loading",mixed:"mixed",month:"month",multiple:"multiple",number:"number",open:"open",optgroup:"optgroup",option:"option",password:"password",progress:"progress",radio:"radio",range:"range",remove:"remove",reset:"reset",submit:"submit",success:"success",text:"text",textarea:"textarea",select:"select",search:"search",selected:"selected",single:"single",tel:"tel",url:"url",value:"select-value",waiting:"waiting",week:"week",wrapper:"select-wrapper"},json:false,labels:false,reset:false,speed:150,submit:function(){}},selectors:{},isIE7:navigator.appVersion.indexOf("MSIE 7.")>-1,init:function(c){var b=this;return function(){var f=a(this),g=this.nodeName.toLowerCase()==="form",d=a(":input:not(:hidden,:plum)",this),e=f;if(!g){e=f.closest("form");e=e.length?e:f.find("form");d=f.is(":input")?f:d}if(e.length){if(!e.data("plum-form")){e.attr("novalidate",true).data("plum-form",a())}e.data("plum-form-options",a.extend(true,{},b.options,c));e.unbind("submit",b.submit).bind("submit",b.submit);e.unbind("reset",b.reset).bind("reset",b.reset);d.each(b.wrap(c||{}))}}},bind:function(){var f=this.options.classes,d=this.element,e=this.wrapper,b;if(!/^(?:button|reset|submit|select-one|select-multiple)$/.test(this.type)){e.css({width:parseInt(e.css("width"),10)-parseInt(e.css("borderLeftWidth"),10)-parseInt(e.css("borderRightWidth"),10)})}d.css({width:e.css("width")}).bind("focus blur",function(c){e[c.type==="focus"?"addClass":"removeClass"](f.focus)});e.bind({mousedown:function(){b=true;e.addClass(f.active)},mouseup:function(){b=false;e.removeClass(f.active)},mouseenter:function(){b&&e.addClass(f.active)},mouseleave:function(){e.removeClass(f.active)}})},label:function(){var b=this,e=this.wrapper.parent(),d=[],f=this.options.speed,g=this.options.classes;if(/(?:select-one|select-multiple|file|submit|button|reset|radio|checkbox)/.test(this.type)){return}if(this.element[0].id){d=a('label[for="'+this.element[0].id+'"]')}if(!d.length&&e.is("label")){d=this.wrapper.parent()}if(!d.length){return}this.wrapper.append('<label class="'+g.label+'">'+d.text()+"</label>");if(e.is("label")){d.after(this.wrapper).remove()}else{d.remove()}d=this.wrapper.children("label");d.css({height:this.element.outerHeight(),left:parseInt(this.element.css("paddingLeft"),10),position:"absolute",right:parseInt(this.element.css("paddingRight"),10),top:0,overflow:"hidden"});d.bind("mousedown",false);d.bind("click",function(){b.element.trigger("focus")});this.element.bind({focus:function(){d.animate({opacity:0.4},f,"linear")},blur:function(){d[this.value?"hide":"show"]().animate({opacity:1},f,"linear")},keypress:function(c){if(c.which>0&&c.which!==8&&c.which!==13){d[(this.value+String.fromCharCode(c.which)).length?"hide":"show"]()}},keyup:function(){d[this.value.length?"hide":"show"]()}});if(this.element[0].value){d.hide()}},listen:function(b){var c=this;a("body").bind("plum",function(e,d){a(":input:not(:plum,:hidden)",d).each(function(){if(a(this).closest(b).length){c.init(c.selectors[b]).call(this)}})})},reset:function(c){var b=a(this);window.setTimeout(function(){b.data("plum-form").trigger("blur").each(function(){var d=a(this).data("plum-form"),e=d.options.classes;if(d.reset){d.reset()}d.wrapper.removeClass(e.invalid);d.wrapper.children("div."+e.info).removeClass(e.success+" "+e.error)})},1)},submit:function(g){var f=a(this),b=f.data("plum-form"),d=a(this).data("plum-form-options"),i=d.classes,e,h;if(b.trigger("blur").filter(function(){return a(this).parent().hasClass(i.invalid)}).length||d.submit.call(f[0])===false){return false}if(d.ajax){e=b.filter(":file");if(e.length&&!a.support.filexhr){f.attr("target","plum-form")}else{g.preventDefault();h=function(){a.ajax({url:f[0].action,data:f.serialize(),dataType:d.json?json:"",type:f[0].method||"POST",success:function(c){d.reset&&f.trigger("reset");d.complete.call(f[0],c)}})};if(e.length){e.eq(0).data("plum-form").upload(h)}else{h()}}}},wrap:function(c){var b=this;return function(){if(this.parentNode.className.match(/plum-form/)){return}var k={},i=a(this),h=i.closest("form"),g=this.nodeName.toLowerCase(),f=(this.getAttribute("type")||this.type||this.nodeName).toLowerCase(),j=i.css("display"),d=i.css("position"),e=new (typeof plum.form[f]==="function"?plum.form[f]:typeof plum.form[g]==="function"?plum.form[g]:typeof plum.form.input==="function"?plum.form.input:function(){});e.options=a.extend(true,{},b.options,e.options,c);k=e.options.classes;e.type=f;e.element=i.data("plum-form",e);e.wrapper=i.wrap(a("<div>",{title:this.title,dir:this.dir,"class":"plum-form "+(k[f]||"")+" "+(k[g]||"")+" "+(this.disabled&&k.disabled||""),css:{display:j==="inline"&&!b.isIE7?"inline-block":j,position:d==="static"?"relative":d,"float":i.css("float"),width:/(?:checkbox|radio|button|submit|reset)/.test(f)?"":this.offsetWidth}})).parent();h.data("plum-form",h.data("plum-form").add(e.element));b.bind.call(e);e.init&&e.init();e.options.labels&&b.label.call(e);if(b.isIE7&&!/(?:button|submit|reset)/.test(f)){e.element.css({width:e.element.width()-(e.element.outerWidth()-e.wrapper.outerWidth())-parseInt(e.element.css("borderLeftWidth"),10)-parseInt(e.element.css("borderRightWidth"),10)})}}},validate:function(e){var d=this,f=this.options.classes,b={email:/^(?:"[\w!#$%&'\*+\.\-\/=?\^_`{|}~]+"|[\w!#$%&'\*+\.\-\/=?\^_`{|}~]+)@(?:\w(?:\-?[\w]+)?\.)*?\w+(?:\.[a-z]{2})?\.[a-z]{2,6}$/,tel:/^(?:(?:\+?1\s*(?:[\.\-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[\.\-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[\.\-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/,url:/^(?:https?:\/\/)?(?:[\w](?:\-?[\w]+)?\.)*?[\w]+(?:\.[a-z]{2})?\.[a-z]{2,4}(\/.+)?$/};return function(){var c=a(this).data("plum-form"),g;if(!c){return}g=a('<div class="'+f.info+'">').insertAfter(this);c.element.bind("blur",function(){var h=true;switch(typeof e){case"string":h=this.value===e;break;case"function":h=!!e.call(this);break;default:"min" in e&&(h=h&&this.value.length>=e.min);"max" in e&&(h=h&&this.value.length<=e.max);"method" in e&&(h="min" in e&&!e.min&&!this.value?true:h&&b[e.method].test(this.value));break}c.wrapper[h?"removeClass":"addClass"](f.invalid);g.removeClass(h?f.error:f.success).addClass(h?f.success:f.error)})}}}}(jQuery));
/*! checkboxes | @since 1.0 */
(function(a){plum.form.checkbox=function(){};plum.form.checkbox.prototype={init:function(){var b=this,g=this.options.classes,d=this.wrapper,f=this.element.closest("form"),e=this.element.bind("click",function(){var c,h=e.attr("class");h=h?h.match(/check-all-([^\s]+)/):"";h=h?h[1]:"";if(!h){d.toggleClass(g.checked);b.checkall(this.name)}else{f.data("plum-form").filter(function(){return this.type==="checkbox"&&!this.disabled&&(this.name===h||a(this).hasClass("check-all-"+h))}).each(function(){var i=a(this).parent();if(e[0].checked||i.hasClass(g.mixed)){this.checked=true;i.removeClass(g.mixed).addClass(g.checked)}else{this.checked=false;i.removeClass(g.checked+" "+g.mixed)}})}}).css({left:"50%",marginLeft:-this.element[0].offsetWidth/2,marginTop:-this.element[0].offsetHeight/2,opacity:0,position:"absolute",top:"50%"});d.css({verticalAlign:""});e[0].checked&&d.addClass(g.checked);b.checkall()},checkall:function(d){var e=this.options.classes,b=this.element.closest("form");b.data("plum-form").filter(function(){return this.type==="checkbox"&&!this.disabled&&/check-all-([^\s]+)/.test(this.className)&&(!d||a(this).hasClass("check-all-"+d))}).each(function(){var h=a(this),f=h.parent(),i=this.className.match(/check-all-([^\s]+)/)[1],c=b.data("plum-form").filter(function(){return this.type==="checkbox"&&!this.disabled&&this.name===i&&!/check-all-([^\s]+)/.test(this.className)}),g=c.filter(":checked");if(g.length===0){this.checked=false;f.removeClass(e.checked+" "+e.mixed)}else{this.checked=true;if(g.length===c.length){f.removeClass(e.mixed).addClass(e.checked)}else{f.addClass(e.checked+" "+e.mixed)}}})},reset:function(){this.wrapper[this.element[0].checked?"addClass":"removeClass"](this.options.classes.checked);this.checkall()}}}(jQuery));
/*! file uploads | @since 1.0 */
(function(a){plum.form.file=function(){};plum.form.file.prototype={options:{file:{autoupload:false,button:"Choose a file...",complete:function(){},errorsize:"Please choose a file smaller than {filesize}.",errortype:"Allowed file types: {filetype}.",files:0,html:'<span class="filename">{filename}</span><span class="remove">&times;</span><span class="filesize">{filesize}</span><div class="progress"><div></div></div>',progress:function(b){b.progressbar.children().stop(true,true).animate({width:b.percent+"%"},150)},size:0,start:function(){},types:[]}},init:function(){var k=this.options.classes,j=this.options.file,i=this.element,g=this.wrapper,h=i.closest("form"),e=h.data("plum-form-upload")||a(),d,b;h.data("plum-form-upload",e.add(i));this.support();i.data("plum-form-queue",[]);i.data("plum-form-index",0);i.attr("multiple",true).addClass("plum-form-0");i.attr("tabindex",-1);i.css({opacity:0,position:"absolute",width:50});i.before(this.create("button"));g.children().wrapAll(this.create("wrapper"));g.append(this.create("list"));d=a(":button",g).parent();i.bind("change",this.change);i.bind("mousedown",function(){b=true;g.addClass(k.active)});i.bind("mouseup",function(){b=false;g.removeClass(k.active)});i.bind("focus",function(){g.removeClass(k.focus);d.addClass(k.focus)});i.bind("blur",function(){g.removeClass(k.focus);d.removeClass(k.focus)});d.bind("mouseover",function(){d.addClass(k.hover);b&&d.addClass(k.active)});d.bind("mouseout",function(){d.removeClass(k.hover+" "+k.active)});d.bind("mousemove",function(f){var c=a(":file",this).eq(-1);c.css({left:-c.outerWidth(),marginLeft:f.pageX-d.offset().left+25,top:f.pageY-d.offset().top-10})})},add:function(e){var d=this.element.data("plum-form-queue"),f=this.options.speed,g=this.options.classes,b=this.wrapper.find("ul").append(this.create("item",e)).children(":last-child").fadeIn(f);a("."+g.remove,b).bind("click",function(){var h=b[0].className.match(/(?:(?:.+\s+)?)?plum-upload-([\d]+)/)[1],c=a(":file.plum-upload-"+h);b.fadeOut(f,function(){b.remove()});typeof d[h]!=="undefined"&&d.splice(h,1);!a.support.file&&c.remove()});if(e.error||!a.support.filexhr){a("."+g.progress,b).remove()}else{a("."+g.progress,b).children().css({width:0})}},change:function(){var d=a(this),h=d.data("plum-form"),j=d.data("plum-form-queue"),m=d.data("plum-form-index"),p=h.options,n={name:this.value,size:"",type:"",error:""},g=0,e,o=p.classes,k=p.file,b;if(a.support.file){if(!p.ajax&&!k.autoupload){j=[];h.wrapper.find("ul").empty()}for(e=this.files.length;g<e;g++){if(k.files&&h.queue.length===k.files){break}b=this.files[g];n.name=b.name||b.fileName;n.size=b.size||b.fileSize;n.type=b.type||b.fileType;n.error=k.size&&n.size>k.size?"<div>"+k.errorsize+"</div>":k.types.length&&a.inArray(n.type,k.types)<0?"<div>"+k.errortype+"</div>":"";if(!n.error){m++;j.push(b)}h.add(n)}k.autoupload&&h.upload()}else{if(k.files&&h.queue.length<=k.files){n.name=n.name.substring(n.name.lastIndexOf("\\")+1);m++;j.push(this.value);h.add(n);d.css({zIndex:-998});d.unbind("change",h.change);d.after(d.clone().val(""));d=d.next();d.data("plum-form",h);d.removeClass("plum-upload-"+(m-1));d.addClass("plum-upload-"+m);d.css({zIndex:998});d.bind("change",h.change)}}d.data("plum-form-queue",j);d.data("plum-form-index",m)},create:function(d,b){var h=this.options.classes,e=this.options.file;switch(d){case"button":var g=this.wrapper[0].title;this.wrapper[0].title="";this.element[0].title="";return a('<button type="button">'+(g||e.button)+"</button>");case"item":return a("<li>",{"class":(b.error?h.error:h.waiting)+" plum-upload-"+this.element.data("plum-form-index"),css:{display:"none"},html:e.html.replace(/\{filename\}/g,b.name).replace(/\{filesize\}/g,this.size(b.size)).replace(/\{filetype\}/g,b.type)+b.error.replace(/\{filesize\}/g,this.size(e.size)).replace(/\{filetype\}/g,e.types.join(", "))+'<div style="clear:both"></div>'});case"list":return a("<ul>",{"class":h.filelist});case"wrapper":return a("<div>",{"class":"plum-form "+h.input+" "+h.button,css:{display:"inline-block",overflow:"hidden",position:"relative",verticalAlign:"top",width:plum.form.prototype.isIE7?"auto":"",zoom:plum.form.prototype.isIE7?1:""}});default:break}},size:function(b){b={B:b};b.K=b.B/1024;b.M=b.K/1024;b.G=b.M/1024;return b.G>1?Math.round(b.G)+" GB":b.M>1?Math.round(b.M)+" MB":b.K>1?Math.round(b.K)+" KB":b.B>0?b.B+" bytes":""},support:function(){a.support.file=window.File&&window.FileList;a.support.filexhr=window.XMLHttpRequestUpload;if(!a.support.filexhr&&!a('iframe[name="plum-form"]').length){a('<iframe name="plum-form">').attr("src","about:blank").css({border:0,left:"-9999em",height:0,position:"absolute",top:"-9999em",width:0}).appendTo("body")}},reset:function(){this.element.data("plum-form-queue",[]);this.element.data("plum-form-index",0);this.wrapper.find(":file:gt(0)").remove();this.wrapper.find("li").fadeOut(this.options.speed,"linear",function(){a(this).remove()})},upload:function(l){var h=this,f=this.element,b=f.closest("form"),d=b.data("plum-form-upload"),i=f.data("plum-form-queue");if(!i.length){d=d.slice(1);b.data("plum-form-upload",d);return !d.length?(l?l():function(){}):d.eq(0).data("plum-form").upload(l)}var n=this.options,j=n.classes,k=this.wrapper.find("li:eq(0)"),e=i.shift(),g=a("."+j.progress,k).slideDown(n.speed),m;m=new XMLHttpRequest;m.upload.addEventListener("loadstart",function(c){k.toggleClass(j.waiting+" "+j.loading);n.file.start.call(k,a.extend(c,{progressbar:g,percent:c.loaded/c.total*100}))},false);m.upload.addEventListener("progress",function(c){n.file.progress.call(k,a.extend(c,{progressbar:g,percent:c.loaded/c.total*100}))},false);m.onreadystatechange=function(c){if(m.readyState===4){n.file.complete.call(k,a.extend(c,{progressbar:g,percent:100}),n.json?a.parseJSON(m.responseText):m.responseText);k.fadeOut(n.speed,function(){k.remove();h.upload(l)})}};m.open("POST",b[0].action,true);m.setRequestHeader("Content-Type",e.type);m.setRequestHeader("X-File-Name",e.name);m.setRequestHeader("X-Requested-With","XMLHttpRequest");m.send(e)}}}(jQuery));
/*! unmatched form elements | @since 1.0 */
(function(a){plum.form.input=function(){};plum.form.input.prototype={init:function(){var d=this.options.classes,b=this.element;switch(this.type){case"textarea":b.css({resize:"none",verticalAlign:"bottom"});break;case"button":case"submit":case"reset":b.attr("formnovalidate",true);break;default:b.css({verticalAlign:"bottom"});this.wrapper.addClass(d.text);break}}}}(jQuery));
/*! radio buttons | @since 1.0 */
(function(a){plum.form.radio=function(){};plum.form.radio.prototype={init:function(){var f=this.options.classes,b=this.wrapper,e=this.element.closest("form"),d=this.element.bind("click",function(){e.data("plum-form").filter(function(){return this.type==="radio"&&this.name===d[0].name}).each(function(){a(this).parent().removeClass(f.checked)});b.addClass(f.checked)}).css({left:"50%",marginLeft:-this.element[0].offsetWidth/2,marginTop:-this.element[0].offsetHeight/2,opacity:0,position:"absolute",top:"50%"});b.css({verticalAlign:""});d[0].checked&&b.addClass(f.checked)},reset:function(){this.wrapper[this.element[0].checked?"addClass":"removeClass"](this.options.classes.checked)}}}(jQuery));
/*! select menus | @since 1.0 */
(function(a){plum.form.select=function(){};plum.form.select.prototype={list:"",string:"",innerwrapper:null,container:null,valuecontainer:null,selected:null,menuoptions:null,original:[],values:[],end:0,index:0,height:0,liHeight:0,maxHeight:0,multiple:false,isopen:false,init:function(){var d=this.element[0],e=this.options.classes,b=this;this.wrapper.addClass(d.multiple?e.multiple+" "+e.open:e.single+" "+e.closed);this.multiple=d.multiple;this.innerwrapper=this.wrapper.prepend(this.create("inner")).children("div");this.valuecontainer=this.innerwrapper.append(this.create("value")).children("div");this.selected=this.valuecontainer.html(this.create("arrow")).children("div:first-child");this.container=this.innerwrapper.append(this.create("menu",{width:d.offsetWidth})).children("ul");this.wrapper.bind("mousedown",false);this.element.bind("rebuild",this.rebuild);this.element.bind("change",this.close);this.element.bind("keydown",{builder:this},this.keydown);this.element.bind("keypress",{builder:this},this.keypress);this.element.trigger("rebuild");this.element.css({opacity:0,position:"absolute",top:0,zIndex:-999});if(d.multiple){return}this.container.css({position:"absolute"});a(document).bind("click",function(f){f=a(f.target);var g=b.options.classes;if(f.closest("div.plum-form."+g.select)[0]!==b.wrapper[0]){b.isopen&&b.close();return this}if(d.disabled||f.hasClass(g.disabled)||f.is("label")||f.is("li")){return this}b[b.isopen?"close":"open"]()})},create:function(d,b){var e=this.options.classes;return function(){switch(d){case"arrow":return a('<div></div><div class="'+e.arrow+'"></div>');case"inner":return a('<div class="'+e.wrapper+'">');case"menu":return a('<ul class="'+e.container+'">').css({overflowX:"hidden",overflowY:"scroll",position:"relative",whiteSpace:"nowrap",width:b.width});case"value":return a('<div class="'+e.value+'">').css({position:"relative",verticalAlign:"bottom"})}}},click:function(e,b){var d=e.data.builder,f=d.options.classes;index=d.menuoptions.index(this),option=d.original[index],pos=0,start=0,end=0;if(e.metaKey&&d.multiple){a(this).toggleClass(f.selected);option.selected=!option.selected;d.index=index}else{if(e.shiftKey&&d.multiple){start=index<d.index?index:d.index;end=index<d.index?d.index:index;a.each(d.original,function(){this.selected=false});d.menuoptions.removeClass(f.selected);for(;start<=end;){d.original[start].selected=true;d.menuoptions.eq(start++).addClass(f.selected)}}else{a(this).addClass(f.selected);option.selected=true;d.end=index;d.index=index;d.menuoptions.not(this).removeClass(f.selected);!d.multiple&&d.selected.text(d.values[index])}}pos=d.liHeight*d.index;if(pos<d.container.scrollTop()){d.container.scrollTop(pos)}else{if(pos>d.height-d.liHeight){d.container.scrollTop(pos-d.height+d.liHeight)}}!b&&d.element.trigger("change")},close:function(){var b=this.wrapper?this:a(this).data("plum-form"),d=b.options.classes;if(this.multiple||!b.isopen){return}b.wrapper.css({zIndex:998});b.container.slideUp(b.options.speed,"linear",function(){b.element.trigger("close");b.wrapper.css({zIndex:""}).toggleClass(d.open+" "+d.closed);b.isopen=false})},open:function(){var d=this,h=this.options.classes,g=this.options.speed,b=a(document).height(),e=this.wrapper.offset().top,f=-this.valuecontainer.outerHeight(true)-parseInt(this.wrapper.css("borderTopWidth"),10);if(e+this.height+50>b){f=b-e-this.height-50}if(f*-1>e+25){f=-e+25}this.isopen=true;this.element.trigger("focus").trigger("open");this.wrapper.css({zIndex:999}).toggleClass(h.open+" "+h.closed);this.container.stop(true,true).animate({marginTop:f},g,"linear");this.container.stop(true,true).slideDown(g,"linear",function(){d.container.scrollTop(d.liHeight*d.index)})},keydown:function(e){var b=e.data.builder,f=b.options.classes,d=0;console.log(e.which);switch(e.which){case 8:b.string=b.string.substring(0,b.string.length-1);e.preventDefault();break;case 13:b.element.trigger("change");break;case 9:case 27:b.close();break;case 38:case 40:if(!e.ctrlKey){b.end=e.which===38?b.end-1>=0?b.end-1:0:b.end+1<b.original.length?b.end+1:b.original.length-1;if(b.end!==b.index){b.click.call(b.menuoptions.eq(b.end)[0],e,true)}e.preventDefault()}break;default:break}},keypress:function(e){var b=e.data.builder,f=b.options.classes,d=0;if(e.which!==13&&e.which!==8){b.string+=String.fromCharCode(e.which);d=b.search(b.string);if(d>-1){b.click.call(b.menuoptions.eq(d)[0],e)}}},search:function(c){c=c.toLowerCase();for(var d=0,b=this.values.length;d<b;d++){if(this.values[d].toLowerCase().substring(0,c.length)===c){return d}}return -1},optionlist:function(){var e=a(this),b=e.closest(".plum-form").find("select").data("plum-form"),g=b.options.classes,d=this.nodeName.toLowerCase(),f=this.label||this.textContent||this.innerText;b.list+='<li class="'+g[d]+" "+(this.disabled&&g.disabled||"")+" "+(this.selected&&g.selected||"")+'">';if(d==="option"){b.list+=f;if(!this.disabled){b.original.push(this);b.values.push(f)}}else{b.list+="<label>"+f+"</label><ul>";e.children().each(b.optionlist);b.list+="</ul>"}b.list+="</li>"},rebuild:function(){var d=a(this),b=d.data("plum-form"),e=b.options.classes;b.original=[];b.values=[];b.list="";b.element.children().each(b.optionlist);b.container.show().html(b.list);b.liHeight=a("li."+e.option,b.container).eq(0).outerHeight(true);b.maxHeight=b.liHeight*(this.size||(this.multiple?5:10));a.each(b.original,function(c){if(this.selected){b.index=c;b.end=c;return false}});b.container.css({display:this.multiple?"block":"none",maxHeight:b.maxHeight});b.height=b.container.outerHeight(true);b.menuoptions=b.container.find("li."+e.option+":not(."+e.disabled+")").bind("click",{builder:b},b.click);b.wrapper[this.disabled?"addClass":"removeClass"](e.disabled).css({width:b.container.outerWidth(true)});!this.multiple&&b.selected.text(d.find("option[selected]").filter(":last").text()||d.find("option:eq(0)").text())},reset:function(){var b=this,d=this.element.val(),e=this.options.classes;this.end=0;this.menuoptions.removeClass(e.selected);if(typeof d==="object"){a.each(d,function(f,c){a.each(b.original,function(g){if(this.value===c){b.menuoptions.eq(g).addClass(e.selected)}})})}else{a.each(this.original,function(c){if(this.value===d){b.menuoptions.eq(c).addClass(e.selected)}})}a.each(this.original,function(c){if(this.selected){b.index=c;return false}})}}}(jQuery));